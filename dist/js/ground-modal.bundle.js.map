{"version":3,"file":"ground-modal.bundle.js","mappings":"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","sources":["webpack://ground/./js/components/modal.js","webpack://ground/./js/utilities/observer.js"],"sourcesContent":["/**\n * Modal module\n * Lightbox library for presenting various types of media\n */\n\nimport { initObserver } from '../utilities/observer';\nimport { PhotoSwipe } from 'photoswipe';\nimport { PhotoSwipeUIDefault } from 'photoswipe/dist/photoswipe-ui-default';\n\nconst Deepmerge = require('deepmerge');\n\nexport default class Modal {\n\t/**\n\t * @param {string} element - Selector\n\t * @param {Object} options - User options\n\t */\n\tconstructor(element, options) {\n\t\tthis.element = element || '[data-modal]';\n\t\tthis.defaults = {\n\t\t\ttriggers: this.element // '[href$=\".jpg\"], [href$=\".png\"], [href$=\".gif\"], [href$=\".jpeg\"], [href$=\".webp\"]'\n\t\t};\n\t\tthis.DOM = {\n\t\t\thtml: document.documentElement,\n\t\t\tbody: document.body\n\t\t};\n\t\tthis.options = options ? Deepmerge(this.defaults, options) : this.defaults;\n\t\tthis.updateEvents = this.updateEvents.bind(this);\n\t\tthis.openPhotoSwipe = this.openPhotoSwipe.bind(this);\n\t\tthis.clickedItem = this.clickedItem.bind(this);\n\n\t\t// window.addEventListener('DOMContentLoaded', () => {\n\t\t\tthis.init();\n\t\t\tthis.initEvents(this.options.triggers);\n\t\t\tinitObserver(this.options.triggers, this.updateEvents);\n\t\t// });\n\t}\n\n\tinit() {\n\t\tthis.DOM.element = document.querySelectorAll(this.element);\n\t\tthis.DOM.pswpElement = document.querySelectorAll('.pswp')[0];\n\t}\n\n\t/**\n\t * Initialize events\n\t * @param {string} triggers - Selectors\n\t */\n\tinitEvents(triggers) {\n\t\tconst elements = document.querySelectorAll(triggers);\n\t\tfor (let i = 0; i < elements.length; i++) {\n\t\t\telements[i].addEventListener('click', this.clickedItem);\n\t\t}\n\t}\n\n\t/**\n\t * Update events\n\t * @param {string} target - New selector\n\t */\n\tupdateEvents(target) {\n\t\ttarget.addEventListener('click', this.clickedItem);\n\t}\n\n\tgetItems(currentTarget) {\n\t\tthis.items = [];\n\t\tlet item;\n\t\tlet size;\n\t\tconst sel = document.querySelectorAll(`[data-modal=\"${event.currentTarget.dataset.modal}\"]`);\n\n\t\tif (event.currentTarget.dataset.modal === '') {\n\t\t\tconst element = event.currentTarget;\n\t\t\tsize = element.getAttribute('data-modal-size').split('x');\n\t\t\titem = {\n\t\t\t\tsrc: element.getAttribute('href'),\n\t\t\t\tw: parseInt(size[0], 10),\n\t\t\t\th: parseInt(size[1], 10),\n\t\t\t\tel: element\n\t\t\t};\n\t\t\tif (element.getElementsByTagName('img')[0] !== undefined) {\n\t\t\t\titem.msrc = element.getElementsByTagName('img')[0].getAttribute('src');\n\t\t\t}\n\t\t\tif (element.getAttribute('data-modal-caption')) {\n\t\t\t\titem.title = element.getAttribute('data-modal-caption');\n\t\t\t}\n\t\t\tthis.items.push(item);\n\t\t} else {\n\t\t\tfor (let index = 0; index < sel.length; index++) {\n\t\t\t\tconst element = sel[index];\n\t\t\t\tsize = element.getAttribute('data-modal-size').split('x');\n\t\t\t\titem = {\n\t\t\t\t\tsrc: element.getAttribute('href'),\n\t\t\t\t\tw: parseInt(size[0], 10),\n\t\t\t\t\th: parseInt(size[1], 10),\n\t\t\t\t\tfirstSlide: currentTarget.isEqualNode(element),\n\t\t\t\t\tel: element\n\t\t\t\t};\n\n\t\t\t\tif (element.getElementsByTagName('img')[0] !== undefined) {\n\t\t\t\t\titem.msrc = element.getElementsByTagName('img')[0].getAttribute('src');\n\t\t\t\t}\n\t\t\t\tif (element.getAttribute('data-modal-caption')) {\n\t\t\t\t\titem.title = element.getAttribute('data-modal-caption');\n\t\t\t\t}\n\t\t\t\tthis.items.push(item);\n\t\t\t}\n\t\t}\n\n\t\treturn this.items;\n\t}\n\n\tclickedItem(event) {\n\t\tthis.openPhotoSwipe(event);\n\t}\n\n\topenPhotoSwipe(event) {\n\t\tevent.preventDefault();\n\n\t\tlet index;\n\t\tconst items = this.getItems(event.currentTarget);\n\n\t\tif (items.length > 0) {\n\t\t\tfor (let i = 0; i < items.length; i++) {\n\t\t\t\tconst element = items[i];\n\n\t\t\t\tif (element.firstSlide) {\n\t\t\t\t\tindex = i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.swiperOptions = {\n\t\t\tindex,\n\t\t\thistory: false,\n\t\t\tshareEl: false,\n\t\t\tgetThumbBoundsFn(index) {\n\t\t\t\tconst thumbnail = items[index].el.getElementsByTagName('img')[0];\n\t\t\t\tconst pageYScroll = window.pageYOffset || document.documentElement.scrollTop;\n\t\t\t\tconst rect = thumbnail.getBoundingClientRect();\n\t\t\t\treturn {\n\t\t\t\t\tx: rect.left,\n\t\t\t\t\ty: rect.top + pageYScroll,\n\t\t\t\t\tw: rect.width\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\n\t\tthis.gallery = new PhotoSwipe(this.DOM.pswpElement, PhotoSwipeUIDefault, items, this.swiperOptions);\n\t\tthis.gallery.init();\n\t\tthis.onOpen();\n\t\tthis.gallery.listen('close', () => {\n\t\t\tthis.onClose();\n\t\t});\n\t}\n\n\tonOpen() {\n\t\tthis.DOM.html.classList.add('is-modal-open');\n\t}\n\n\tonClose() {\n\t\tthis.DOM.html.classList.remove('is-modal-open');\n\t}\n\n\tdestroy() {\n\t\tthis.gallery.destroy();\n\t}\n}\n","/**\n * Observe DOM Node Changes\n * @param {string} triggers - Selectors\n * @param {requestCallback} cb - The callback that handles the response.\n *\n * @see https://stackoverflow.com/questions/56608748/how-to-use-queryselectorall-on-the-added-nodes-in-a-mutationobserver\n */\nexport function initObserver(triggers, callback) {\n\tconst filterSelector = (selector, mutationsList) => {\n\t\t// We can't create a NodeList; let's use a Set\n\t\tconst result = new Set();\n\t\t// Loop through the mutationsList...\n\t\tfor (const { addedNodes } of mutationsList) {\n\t\t\tfor (const node of addedNodes) {\n\t\t\t\t// console.log(node);\n\n\t\t\t\t// If it's an element...\n\t\t\t\tif (node.nodeType === 1) {\n\t\t\t\t\t// Add it if it's a match\n\t\t\t\t\tif (node.matches(selector)) {\n\t\t\t\t\t\tresult.add(node);\n\t\t\t\t\t}\n\t\t\t\t\t// Add any children\n\t\t\t\t\tfor (const entry of node.querySelectorAll(selector)) {\n\t\t\t\t\t\tresult.add(entry);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/* mutationsList.map((e) => e.addedNodes).forEach((n) => {\n\t\t\t\tif (n.nodeType === 1) {\n\t\t\t\t\tif (n.matches(selector)) {\n\t\t\t\t\t\tresult.add(n);\n\t\t\t\t\t}\n\t\t\t\t\t// Add any children\n\t\t\t\t\tn.querySelectorAll(selector).forEach((c) => result.add(c));\n\t\t\t\t}\n\t\t\t}); */\n\n\t\treturn [...result]; // Result is an array, or just return the set\n\t};\n\n\tconst observerCallback = (mutationsList) => {\n\t\tconst result = filterSelector(triggers, mutationsList);\n\t\tresult.forEach((element) => {\n\t\t\tcallback(element);\n\t\t});\n\t};\n\n\tconst config = {\n\t\tchildList: true,\n\t\tattributes: false,\n\t\tcharacterData: false,\n\t\tsubtree: true\n\t};\n\tconst observer = new MutationObserver(observerCallback);\n\tobserver.observe(document.documentElement, config);\n\t//observer.disconnect();\n}\n"],"names":["initObserver","PhotoSwipe","PhotoSwipeUIDefault","Deepmerge","require","Modal","element","options","defaults","triggers","DOM","html","document","documentElement","body","updateEvents","bind","openPhotoSwipe","clickedItem","init","initEvents","querySelectorAll","pswpElement","elements","i","length","addEventListener","target","currentTarget","items","item","size","sel","event","dataset","modal","getAttribute","split","src","w","parseInt","h","el","getElementsByTagName","undefined","msrc","title","push","index","firstSlide","isEqualNode","preventDefault","getItems","swiperOptions","history","shareEl","getThumbBoundsFn","thumbnail","pageYScroll","window","pageYOffset","scrollTop","rect","getBoundingClientRect","x","left","y","top","width","gallery","onOpen","listen","onClose","classList","add","remove","destroy","callback","filterSelector","selector","mutationsList","result","Set","addedNodes","node","nodeType","matches","entry","observerCallback","forEach","config","childList","attributes","characterData","subtree","observer","MutationObserver","observe"],"sourceRoot":""}